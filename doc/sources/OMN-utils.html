<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
<link rel="Stylesheet" type="text/css" href="../cludg.css"/>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
<title>
OMN-utils</title>
</head>
<body>
<div id="navbar">
<table cellspacing="0" cellpadding="0" border="0" style="width: 100%;">
<colgroup span="3">
<col width="0*"/>
<col width="0*"/>
<col width="1*"/>
</colgroup>
<tr>
<td align="left" valign="baseline">
<a href="utils.html">
Prev:&nbsp;utils</a>
<br/>
<a href="rhythm.html">
Next:&nbsp;rhythm</a>
</td>
<td>
&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td align="left" valign="baseline">
<span class="upchain">
<b>
OMN-utils</b>
<br/>
<a href="../index.html">
Index</a>
</span>
&nbsp;&nbsp;&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<div class="cludg-doc-body">
<h2>
OMN-utils
</h2>
<table style="width: 100%;" class="summary-table">
<tr class="table-heading-color">
<th class="summary" colspan="2">
Function summary</th>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181256">
copy-time-signature</a>
</td>
<td class="summary">
music-with-time-signature music-to-rebar</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181259">
count-notes</a>
</td>
<td class="summary">
notes</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181257">
edit-omn</a>
</td>
<td class="summary">
type notation fun <em>&amp;key</em> (flat t)</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181262">
length-add</a>
</td>
<td class="summary">
<em>&amp;rest</em> length-values</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181261">
length-subtract</a>
</td>
<td class="summary">
<em>&amp;rest</em> length-values</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181258">
note-no</a>
</td>
<td class="summary">
music</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181260">
phrase-lengths</a>
</td>
<td class="summary">
lengths</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181263">
plotter</a>
</td>
<td class="summary">
data <em>&amp;optional</em> (number 100)</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="OMN-utils.html#_g181264">
pprint-part</a>
</td>
<td class="summary">
part <em>&amp;optional</em> (stream *standard-output*)</td>
</tr>
</table>
<div class="defun">
<div class="defunsignatures">
<a id="_g181256">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
copy-time-signature&nbsp;&nbsp;</td>
<td class="lambda-list">
music-with-time-signature music-to-rebar</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Rebars `music-to-rebar' so that it fits the meter of `music-with-time-signature'. 
 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181257">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
edit-omn&nbsp;&nbsp;</td>
<td class="lambda-list">
type notation fun <em>&amp;key</em> (flat t)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Use function `fun', defined for transforming individual OMN parameters of `type' (e.g., <span class="keyword">
:length, </span>
or <span class="keyword">
:velocity) </span>
to transform omn expression `notation'. This function is intended as a convenient way to generalise functions your functions to support omn notation as input. 
 </p>
<p>
Args: 
 </p>
<ul>
<li>
<p>
type: a keyword like <span class="keyword">
:length, </span>
<span class="keyword">
:pitch, </span>
<span class="keyword">
:velocity, </span>
<span class="keyword">
:duration, </span>
or <span class="keyword">
:articulation </span>
(any keyword supported by function omn or make-omn). 
 </p>
</li>
<li>
<p>
fun: a function expecting a parameter sequence of given type. It is sufficient to support only a flat input list, support for nested lists is added implicitly. 
 </p>
</li>
<li>
<p>
notation: a omn sequence or a plain parameter list (can be nested). 
 </p>
</li>
<li>
<p>
flat (default T): whether or not `fun' expects a flat input list. 
 </p>
</li>
</ul>
<p>
Example: roll your own transposition supporting omn input 
 first aux def supporting only pitches 
 </p>
<pre>
    (defun my-transposition-aux (interval pitches) 
       (midi-to-pitch (loop for p in (pitch-to-midi pitches) 
                            collect (+ p interval)))) </pre>
<p>

 test 
 </p>
<pre>
    (my-transposition-aux 7 '(c4 e4 g4))  
      =&gt; (g4 b4 d5) </pre>
<p>
variant supporting also omn expressions 
 </p>
<pre>
    (defun my-transposition (interval omn) 
       (edit-omn :pitch omn 
                 #'(lambda (ps) (my-transposition-aux interval ps)))) </pre>
<p>
test with nested OMN including a rest 
 </p>
<pre>
    (my-transposition 7 '((q c4 mp -q q e4 q f4) (h g4 tr2))) 
      =&gt; ((q g4 mp - b4 c5) (h d5 mp tr2)) </pre>
<p>
More information at {https://opusmodus.com/forums/topic/799-user-functions-supporting-arbitrary-omn-input-â€“-defining-them-more-easily/}. 
 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181258">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
note-no&nbsp;&nbsp;</td>
<td class="lambda-list">
music</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Returns the number of notes in music, which is a list of lengths values of OMN expressions. 
 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181259">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
count-notes&nbsp;&nbsp;</td>
<td class="lambda-list">
notes</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Returns number of notes (ignoring rests) in length list or other OMN expression. 
 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181260">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
phrase-lengths&nbsp;&nbsp;</td>
<td class="lambda-list">
lengths</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Returns the number of notes between rests in the given lengths. 
 
 Args: 
 </p>
<ul>
<li>
<p>
length: lengths or OMN (list or list of list). 
 </p>
</li>
</ul>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181261">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
length-subtract&nbsp;&nbsp;</td>
<td class="lambda-list">
<em>&amp;rest</em> length-values</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Subtraction for OMN length values. 
 </p>
<p>
Example: 
 </p>
<pre>
    (length-subtract 'w 'q) 
     =&gt; h. </pre>
<p>

 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181262">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
length-add&nbsp;&nbsp;</td>
<td class="lambda-list">
<em>&amp;rest</em> length-values</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Subtraction for OMN length values. 
 </p>
<p>
Example: 
 </p>
<pre>
    (length-add 'w 'q) 
     =&gt; wq </pre>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181263">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
plotter&nbsp;&nbsp;</td>
<td class="lambda-list">
data <em>&amp;optional</em> (number 100)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Aux function for plotting fenvs 
 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g181264">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
pprint-part&nbsp;&nbsp;</td>
<td class="lambda-list">
part <em>&amp;optional</em> (stream *standard-output*)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Pretty prints a part one bar a time, adding a bar line comment before each bar. 
 </p>
<p>
Args: 
 </p>
<ul>
<li>
<p>
part: nested OMN list. 
 </p>
</li>
</ul>
<p>
Example: 
 </p>
<pre>
    (pprint-part '((q c4 d4 e4) (h f4 q e4) (h. d2))) </pre>
</div>
</div>
</div>
<div class="cludg-footer">
Generated by&nbsp;<a href="mailto:ihatchondo@common-lisp.net" lang="en">
CLDOC</a>
- 2017-08-15 20:19:36</div>
</body>
</html>
