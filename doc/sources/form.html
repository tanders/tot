<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
<link rel="Stylesheet" type="text/css" href="../cludg.css"/>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
<title>
form</title>
</head>
<body>
<div id="navbar">
<table cellspacing="0" cellpadding="0" border="0" style="width: 100%;">
<colgroup span="3">
<col width="0*"/>
<col width="0*"/>
<col width="1*"/>
</colgroup>
<tr>
<td align="left" valign="baseline">
<a href="constraints.html">
Prev:&nbsp;constraints</a>
<br/>
<a href="orchestration.html">
Next:&nbsp;orchestration</a>
</td>
<td>
&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td align="left" valign="baseline">
<span class="upchain">
<b>
form</b>
<br/>
<a href="../index.html">
Index</a>
</span>
&nbsp;&nbsp;&nbsp;&nbsp;</td>
</tr>
</table>
</div>
<div class="cludg-doc-body">
<h2>
form
</h2>
<table style="width: 100%;" class="summary-table">
<tr class="table-heading-color">
<th class="summary" colspan="2">
Function summary</th>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="form.html#_g180354">
alternate-omns</a>
</td>
<td class="summary">
ids seqs-of-seqs <em>&amp;key</em> (append? nil)</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="form.html#_g180353">
condense</a>
</td>
<td class="summary">
sequence test <em>&amp;key</em> (section nil)</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="form.html#_g180352">
developing-substitute</a>
</td>
<td class="summary">
map sequence otherwise</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="form.html#_g180356">
map-segments</a>
</td>
<td class="summary">
segments fun arg-seqs <em>&amp;key</em> (section nil) (constant-args nil)</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="form.html#_g180357">
rotate-omn</a>
</td>
<td class="summary">
n sequence <em>&amp;key</em> (parameter :pitch) (flat t) (section nil)</td>
</tr>
<tr class="table-row-color">
<td class="summary-name">
<a href="form.html#_g180355">
_alternate-omns-aux</a>
</td>
<td class="summary">
ids hash append?</td>
</tr>
</table>
<div class="defun">
<div class="defunsignatures">
<a id="_g180352">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
developing-substitute&nbsp;&nbsp;</td>
<td class="lambda-list">
map sequence otherwise</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Returns a transformation of `sequence', where elements that match entries given in `map' are replaced with given new items, and -- if not contained in map -- with an `otherwise' element. However, this function allows for replacements that develop over time and where the sequence of the developments could be generated algorithmically by other functions: When multiple new and otherwise replacements are given, these are used by and by in their given order (circulating, if the end of the given sequence is reached). 
 
 Replacements in the mapping can also be specified by functions returning the necessary replacement. 
 </p>
<p>
Note that sequence elements to replace can be arbitrary values, including subsequences. 
 
 </p>
<p>
Args: 
 </p>
<ul>
<li>
<p>
map: old-new pairs (list of two-element lists) 
 </p>
</li>
<li>
<p>
sequence: sequence (list) to transform 
 </p>
</li>
<li>
<p>
otherwise: flat list of alternative replacements. Per sublist, only a single replacement value is chosen. 
 </p>
</li>
</ul>
<p>
Examples: 
 </p>
<pre>
    (developing-substitute '((1 (a b c)) 
       			     (2 (h i j))) 
                            '(1 1 2 1 3 2 1) 
                            '(x y z)) 
     =&gt; (a b h c x i a) </pre>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g180353">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
condense&nbsp;&nbsp;</td>
<td class="lambda-list">
sequence test <em>&amp;key</em> (section nil)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Beethoven-like condensation of music. All notes for which a given test function returns `nil' are removed, and their preceeding note is extended by their duration. 
 </p>
<p>
Args: 
 </p>
<ul>
<li>
<p>
test: Boolean function expecting individual parameters of each note in `OMN' 
 </p>
</li>
<li>
<p>
sequence: An OMN sequence 
 </p>
</li>
</ul>
<p>
Example: 
 </p>
<p>
</p>
<pre>
    (setf my-motif '((q. c4 e d4 q. e4 e f4) (h g4 -h))) </pre>
<p>
</p>
<pre>
    (condense my-motif 
               #'(lambda (dur pitch &amp;rest other-args)   
                   (&gt; (omn-encode dur) 1/4))) </pre>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g180354">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
alternate-omns&nbsp;&nbsp;</td>
<td class="lambda-list">
ids seqs-of-seqs <em>&amp;key</em> (append? nil)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
This function alternates between sublists of multiple omn sequences. It can be useful, e.g., to switch between different musical characteristics, but have some kind of development within each characteristic. This is a powerful function for organising musical form on a higher level. 
 </p>
<p>
Args: 
 </p>
<ul>
<li>
<p>
ids (list of 0-based integers): indicating the position of OMN expressions in seqs-of-seqs. 
 </p>
</li>
<li>
<p>
seqs-of-seqs (list of lists of OMN sequences or plain OMN parameters): specifies material between which to switch. The top-level list positions indicate the different materials pointed to by `ids'. The next level specifies the order in which material will be included when `ids' contains repetitions of an id. This order is circling. The lowest level is the actual material either as a flat list (each a single bar), or as a nested list (multiple bars). In case of a nested list at the lowest level you likely want to set `append' to T. 
 </p>
</li>
<li>
<p>
append? (Boolean): whether or not nested OMN sequences should be appended instead of been combined in a list. 
 </p>
</li>
</ul>
<p>
Examples: 
 </p>
<p>
The following example demonstrates the use of the arguments `ids' and `seqs-of-seqs' with a flat sequence of note lengths. Note the nesting of `seqs-of-seqs', as explained by the comments. 
 
 </p>
<pre>
    (alternate-omns 
      ;; sequence of IDs 
      '(0 0 1 1 0 0) 
      '(;; ID 0 material/gestures  
        (;; for first occurance of ID 0 (and again, when circling) 
         (h q q) 
         ;; second occurance of ID 0 etc. 
         (h. e e)) 
        ;; ID 1 material//gestures (only one segment, repeated always) 
        ((e e e e e e e e)) 
        )) 
     ; =&gt; ((h q q) (h. e e) (e e e e e e e e) (e e e e e e e e) (h q q) (h. e e)) </pre>
<p>
Now, the power of algorithmic composition lies in the fact that each of these arguments can be algorithmically generated. The next example demontrates that. It also demonstrates how the materials/gestures can be OMN expressions with multiple parameters. Still, each of these gestures consist in a single bar (gestures are not nested, though they are nested within two list levels). 
 </p>
<p>
</p>
<pre>
    (alternate-omns  
      ;; random sequence of IDs 
      (gen-eval 10 '(rnd-pick '(0 1))) 
      (list  
       ;; sequence of first kind of musical gestures 
       (make-omn 
        :length (length-rest-series 
     	    (rnd-sample 7 '(7 8 9)) 
     	    (length-divide 3 2 
     			   (rnd-sample 7 '((q q q) (h e e) (h.) (h q))))) 
        :pitch '(d4 e4 f4 g4) 
        :velocity '(pp)) 
       ;; sequence of second kind of musical gestures 
       (make-omn 
        :length '(s s s s) 
        :pitch (gen-rotate :right '(c5 d5 f5 a5 g5 e5) :type :seq) 
        :velocity '(ff) 
        :span :pitch))) </pre>
<p>
Remember that resulting OMN expressions can be 're-barred'. This is useful, e.g., for gestures that exceed a single bar but are still stored in a flat list (again, nested within two list levels). 
 </p>
<p>
</p>
<pre>
    (omn-to-time-signature  
      (alternate-omns 
       '(0 0 1 0 1 0 1 1 0 0 1 1 1) 
       (list 
        (make-omn  
         :length (gen-rotate :left '(-1/20 1/20 1/20 1/20 1/20) :type :seq) 
         :pitch '(d4 e4 f4 g4) 
         :velocity '(ff)) 
        (make-omn 
         :length '(q e e) 
         :pitch (gen-rotate :left '(c5 e5 f5) :type :seq) 
         :velocity '(pp pp) 
         :attribute '(ten stacc stacc) 
         :span :pitch))) 
      '(4 4)) </pre>
<p>
Alternatively, it is possible to use gestures that consists of nested lists for representing bars (still nested within two higher list levels). In that case, you typically want to set `append?' to T so that the result is a standard OMN sequence with only a single level of nesting, as shown below. 
 </p>
<p>
</p>
<pre>
    (alternate-omns '(0 0 1 1 0 0)  
                     '((;; one nested gestures, circled in case of repeated IDs 
     		       ((-h q c4 p leg) (q. f4 leg e g4 leg q a4 leg) (h. g4))) 
                       (;; one nested gestures 
     		       ((q g4 f leg c5 leg e c4 stacc d4 stacc e4 f4 stacc) (q g4 stacc -h.)))) 
                     :append? T) </pre>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g180355">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
_alternate-omns-aux&nbsp;&nbsp;</td>
<td class="lambda-list">
ids hash append?</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Aux def 
 </p>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g180356">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
map-segments&nbsp;&nbsp;</td>
<td class="lambda-list">
segments fun arg-seqs <em>&amp;key</em> (section nil) (constant-args nil)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="defun">
<div class="defunsignatures">
<a id="_g180357">
</a>
<table cellpadding="0" cellspacing="0" width="100%">
<colgroup span="3">
<col width="0*"/>
<col width="1*"/>
<col width="0*"/>
</colgroup>
<tbody>
<tr>
<td class="symbol-name">
rotate-omn&nbsp;&nbsp;</td>
<td class="lambda-list">
n sequence <em>&amp;key</em> (parameter :pitch) (flat t) (section nil)</td>
<td class="symbol-type">
&nbsp;[Function]</td>
</tr>
</tbody>
</table>
</div>
<div class="doc-body">
<p>
Rotate the OMN `sequence' by `n' positions. 
 </p>
<p>
Args: 
 </p>
<ul>
<li>
<p>
n: an integer (rotation number, positive or negative) or a list of ints. The keywords <span class="keyword">
:left </span>
and <span class="keyword">
:right </span>
are equivalents of the integer values -1 and 1. If `n' is a list then `flat' must be nil. 
 </p>
</li>
<li>
<p>
sequence: OMN expression. 
 </p>
</li>
<li>
<p>
parameter (keyword): which parameter to rotate (e.g., <span class="keyword">
:length, </span>
<span class="keyword">
:pitch...). </span>

 </p>
</li>
<li>
<p>
flat (Boolean): whether to rotate the full flattened sequence (T) or subsequences. 
 </p>
</li>
<li>
<p>
section (list of ints): positions of sublists to process. This argument is ignored if flat is T. 
 </p>
</li>
</ul>
<p>
Examples: 
 </p>
<p>
</p>
<pre>
    (rotate-omn :right '((-h q c4) (q. f4 e g4 q a4) (h. g4))) 
      
     (rotate-omn :left '((-h q c4) (q. f4 e g4 q a4) (h. g4)) :parameter :length) 
      
     (rotate-omn 2 '((-h q c4) (q. f4 e g4 q a4) (h. g4)) :section '(1 2) :flat nil) </pre>
<p>
The following examples are rotating subsequences separately. 
 </p>
<p>
</p>
<pre>
    (rotate-omn '(0 1 2) '((-h e c4 e4) (q. f4 e g4 q a4) (q g4 f4 e e4 d4)) :flat nil) ; default parameter pitch 
      
     (rotate-omn '(0 1 2) '((-h e c4 e4) (q. f4 e g4 q a4) (q g4 f4 e e4 d4)) :flat nil :parameter :length) 
      
     (rotate-omn '(2 1) '((-h e c4 e4) (q. f4 e g4 q a4) (q g4 f4 e e4 d4)) :section '(1 2) :flat nil :parameter :length) </pre>
</div>
</div>
</div>
<div class="cludg-footer">
Generated by&nbsp;<a href="mailto:ihatchondo@common-lisp.net" lang="en">
CLDOC</a>
- 2018-03-27 17:01:29</div>
</body>
</html>
